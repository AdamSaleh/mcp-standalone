FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"bmFtZTogY29yZG92YS1hcGIKaW1hZ2U6IGZlZWRoZW5yeS9jb3Jkb3ZhLWFwcC1hcGIKZGVzY3Jp\
cHRpb246IFRoaXMgaXMgYSBzYW1wbGUgYXBwbGljYXRpb24gZ2VuZXJhdGVkIGJ5IGFwYiBpbml0\
CmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKdGFnczogCiAgLSBtb2JpbGUKbWV0YWRh\
dGE6CiAgZGlzcGxheU5hbWU6IENvcmRvdmEgQXBwCiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNv\
bkNsYXNzOiBmYSBmYS1tb2JpbGUKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlw\
dGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBjb3Jkb3ZhLWFwYgogICAgZnJlZTogVHJ1\
ZQogICAgbWV0YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJzOiAKICAgIC0gbmFtZTogYXBwTmFtZQog\
ICAgICByZXF1aXJlZDogVHJ1ZQogICAgICBkZWZhdWx0OiBteWFwcAogICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgdGl0bGU6IHlvdXIgbmV3IGFwcHMgbmFtZQ=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
